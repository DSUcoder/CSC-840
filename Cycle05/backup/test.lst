     1                                  ; nasm -f elf -l test.lst test.asm
     2                                  ; gcc -o test test.o
     3                                  
     4                                    SECTION .text
     5                                    global main
     6                                    global gadget
     7                                  
     8                                  main:
     9 00000000 B854414D55                mov eax, 0x554D4154
    10 00000005 90                        nop
    11 00000006 90                        nop
    12 00000007 90                        nop
    13 00000008 90                        nop
    14 00000009 90                        nop
    15 0000000A 90                        nop
    16 0000000B 90                        nop
    17 0000000C 90                        nop
    18                                    
    19 0000000D BB00000000                mov ebx,0
    20 00000012 B801000000                mov eax,1
    21 00000017 CD80                      int 0x80
    22                                  
    23 00000019 B8894108C3                mov eax, 0xC3084189
    24 0000001E 894108                    mov [ecx+8],eax
    25 00000021 C3                        ret
    26                                  
    27                                  gadget:
    28 00000022 58                        pop eax
    29 00000023 C3                        ret
    30                                  
